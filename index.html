<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    
    <!-- Safari / iOS / cross-browser compatibility -->
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    
    <!-- Primary Meta Tags -->
    <title>Chess Game - Play Online Chess with Custom Themes</title>
    <meta name="title" content="Chess Game - Play Online Chess with Custom Themes">
    <meta name="description" content="Play chess online with friends or against AI. Customize your board with 50+ themes, multiple piece styles, and play multiplayer games. Free online chess game.">
    <meta name="keywords" content="chess, online chess, play chess, chess game, multiplayer chess, chess themes, chess customization, free chess">
    <meta name="author" content="Chess Game">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    
    <!-- Favicon and Manifest -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ôüÔ∏è</text></svg>">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://your-chess-site.vercel.app/">
    <meta property="og:title" content="Chess Game - Play Online Chess with Custom Themes">
    <meta property="og:description" content="Play chess online with friends or against AI. Customize your board with 50+ themes and multiple piece styles.">
    <meta property="og:image" content="https://your-chess-site.vercel.app/og-image.png">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://your-chess-site.vercel.app/">
    <meta property="twitter:title" content="Chess Game - Play Online Chess with Custom Themes">
    <meta property="twitter:description" content="Play chess online with friends or against AI. Customize your board with 50+ themes and multiple piece styles.">
    <meta property="twitter:image" content="https://your-chess-site.vercel.app/og-image.png">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ôüÔ∏è</text></svg>">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ôüÔ∏è</text></svg>">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#667eea">
    
    <!-- Stylesheet -->
    <link rel="stylesheet" href="styles.css">
    
    <!-- Preconnect for external resources -->
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="dns-prefetch" href="https://unpkg.com">
</head>
<body>
    <div class="rain-container" id="rain-container"></div>
    <div class="container">
        <header>
            <h1>‚ôî Chess Game ‚ôî</h1>
            <div class="game-info">
                <div class="turn-indicator">
                    <span id="current-turn">White's Turn</span>
                </div>
                <div class="game-status" id="game-status"></div>
                <div class="timers" style="display: none;">
                    <div class="timer white-timer" id="white-timer">
                        <div class="timer-label">White</div>
                        <div class="timer-display" id="white-time">10:00</div>
                    </div>
                    <div class="timer black-timer" id="black-timer">
                        <div class="timer-label">Black</div>
                        <div class="timer-display" id="black-time">10:00</div>
                    </div>
                </div>
                <div class="user-info" id="user-info">
                    <span id="username-display"></span>
                    <button id="settings-btn" class="settings-btn" title="Settings">‚öôÔ∏è</button>
                    <button id="logout-btn" class="logout-btn">Logout</button>
                </div>
            </div>
        </header>

        <!-- Settings Modal -->
        <div id="settings-modal" class="settings-modal">
            <div class="settings-modal-content">
                <div class="settings-modal-header">
                    <h2>‚öôÔ∏è Settings</h2>
                    <button class="settings-close-btn" id="settings-close-btn">&times;</button>
                </div>
                <div class="settings-modal-body">
                    <div class="settings-section">
                        <h3>Quick Settings</h3>
                        <div class="settings-options">
                            <button class="settings-option-btn" id="settings-profile-btn">
                                <span>üë§</span> Profile Settings
                            </button>
                            <button class="settings-option-btn" id="settings-customization-btn">
                                <span>üé®</span> Customize Colors & Themes
                            </button>
                            <button class="settings-option-btn" id="settings-timer-btn">
                                <span>‚è±Ô∏è</span> Timer Settings
                            </button>
                            <button class="settings-option-btn" id="settings-bot-btn">
                                <span>ü§ñ</span> Bot Settings
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <main>
            <div class="chess-container">
                <div class="board-container">
                    <div class="board-with-timers">
                        <div class="side-timers">
                            <div class="timers-box-title">‚è±Ô∏è TIMERS</div>
                            
                            <!-- Black Timer & Profile -->
                            <div class="timer-with-profile">
                                <div class="side-timer side-timer-row-4" id="side-timer-black" data-color="black" data-row="4">
                                    <div class="timer-profile-pic" id="black-timer-profile-pic">
                                        <span class="timer-profile-icon">‚ôö</span>
                                    </div>
                                    <div class="timer-label">BLACK</div>
                                    <div class="timer-display" id="black-time-side">10:00</div>
                                </div>
                                <div class="timer-player-profile black-timer-profile">
                                    <div class="timer-profile-avatar" id="black-profile-avatar">‚ôü</div>
                                    <div class="timer-profile-name" id="black-profile-name">Player 2</div>
                                </div>
                            </div>
                            
                            <!-- White Timer & Profile -->
                            <div class="timer-with-profile">
                                <div class="side-timer side-timer-row-5" id="side-timer-white" data-color="white" data-row="5">
                                    <div class="timer-profile-pic" id="white-timer-profile-pic">
                                        <span class="timer-profile-icon">‚ôî</span>
                                    </div>
                                    <div class="timer-label">WHITE</div>
                                    <div class="timer-display" id="white-time-side">10:00</div>
                                </div>
                                <div class="timer-player-profile white-timer-profile">
                                    <div class="timer-profile-avatar" id="white-profile-avatar">‚ôô</div>
                                    <div class="timer-profile-name" id="white-profile-name">Player 1</div>
                                </div>
                            </div>
                        </div>
                        <div class="board-wrapper">
                            <div id="chessboard" class="chessboard"></div>
                            <div class="player-profiles">
                                <div class="player-profile white-profile">
                                    <div class="profile-avatar">
                                        <span class="avatar-icon">‚ôî</span>
                                    </div>
                                    <div class="profile-info">
                                        <div class="profile-name" id="white-player-profile">White</div>
                                        <div class="profile-role">White Player</div>
                                    </div>
                                    <div class="profile-status" id="white-player-status"></div>
                                </div>
                                <div class="player-profile black-profile">
                                    <div class="profile-avatar">
                                        <span class="avatar-icon">‚ôö</span>
                                    </div>
                                    <div class="profile-info">
                                        <div class="profile-name" id="black-player-profile">Black</div>
                                        <div class="profile-role">Black Player</div>
                                    </div>
                                    <div class="profile-status" id="black-player-status"></div>
                                </div>
                                <button class="profile-button white-profile-button" id="white-profile-button" title="View White Player Profile">
                                    <span class="profile-button-icon">üë§</span>
                                </button>
                            </div>
                        </div>
                        <div class="board-controls">
                            <button id="start-game-btn" class="start-game-btn">Start Game</button>
                            <button id="lessons-btn" class="btn btn-secondary lessons-btn" title="Learn chess">üìö Lessons</button>
                            <button id="draw-btn" class="btn btn-secondary draw-btn">Draw</button>
                            <button id="resign-btn" class="btn btn-secondary resign-btn">Resign</button>
                            <button id="review-btn" class="btn btn-primary review-btn" style="display: none;">üìñ Review Game</button>
                            <div class="color-selector">
                                <label for="player-color-select" class="color-select-label">Play As:</label>
                                <select id="player-color-select" class="color-select">
                                    <option value="white" selected>White</option>
                                    <option value="black">Black</option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Review Controls (hidden by default) -->
                        <div id="review-controls" class="review-controls" style="display: none;">
                            <div class="review-header">
                                <span>üìñ Game Review</span>
                                <button id="exit-review-btn" class="btn btn-small">‚úï Exit</button>
                            </div>
                            <div class="review-navigation">
                                <button id="review-start-btn" class="btn btn-small" title="Go to start">‚èÆ</button>
                                <button id="review-prev-btn" class="btn btn-small" title="Previous move">‚óÄ</button>
                                <span id="review-move-display" class="review-move-display">Move 0/0</span>
                                <button id="review-next-btn" class="btn btn-small" title="Next move">‚ñ∂</button>
                                <button id="review-end-btn" class="btn btn-small" title="Go to end">‚è≠</button>
                            </div>
                            <div id="review-move-info" class="review-move-info"></div>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar">
                    <div class="multiplayer-section">
                        <h3>Online Play</h3>
                        <div class="player-names">
                            <div class="player-name-input">
                                <label for="white-player-name">White Player</label>
                                <input type="text" id="white-player-name" placeholder="Enter username" value="Player 1">
                                <div class="profile-picture-upload">
                                    <label for="white-player-pic" class="profile-pic-label">
                                        <span class="profile-pic-icon">üì∑</span>
                                        <span class="profile-pic-text">Upload Profile Picture</span>
                                    </label>
                                    <input type="file" id="white-player-pic" accept="image/*" style="display: none;">
                                    <div class="profile-pic-preview" id="white-player-pic-preview"></div>
                                </div>
                            </div>
                            <div class="player-name-input">
                                <label for="black-player-name">Black Player</label>
                                <input type="text" id="black-player-name" placeholder="Enter username" value="Player 2">
                                <div class="profile-picture-upload">
                                    <label for="black-player-pic" class="profile-pic-label">
                                        <span class="profile-pic-icon">üì∑</span>
                                        <span class="profile-pic-text">Upload Profile Picture</span>
                                    </label>
                                    <input type="file" id="black-player-pic" accept="image/*" style="display: none;">
                                    <div class="profile-pic-preview" id="black-player-pic-preview"></div>
                                </div>
                            </div>
                        </div>
                        <div class="room-controls">
                            <!-- Color Selection for Creating Room -->
                            <div class="color-select-section" style="margin-bottom: 10px;">
                                <label style="font-weight: 600; margin-right: 10px;">Play as:</label>
                                <select id="create-color-select" style="padding: 8px 12px; border-radius: 6px; border: 2px solid #667eea; font-size: 1rem;">
                                    <option value="white">‚¨ú White (moves first)</option>
                                    <option value="black">‚¨õ Black</option>
                                </select>
                            </div>
                            <button id="create-room-btn" class="btn btn-primary">Create Room</button>
                            
                            <div class="join-room-section">
                                <input type="text" id="room-code-input" placeholder="Enter room code" maxlength="6">
                                <button id="join-room-btn" class="btn btn-secondary">Join Room</button>
                                <button id="list-rooms-btn" class="btn btn-small" style="margin-top: 5px; font-size: 0.85rem; padding: 6px 12px;">Show Available Rooms</button>
                            </div>
                            <div id="room-info" class="room-info" style="display: none;">
                                <div class="room-code-display">
                                    <strong>Room Code:</strong> <span id="room-code-display"></span>
                                    <button id="copy-room-code-btn" class="btn-small">Copy</button>
                                </div>
                                <div class="opponent-info">
                                    <div><strong>White:</strong> <span id="white-player-display"></span></div>
                                    <div><strong>Black:</strong> <span id="black-player-display"></span></div>
                                </div>
                                
                                <!-- Invite Link Section -->
                                <div class="invite-section" style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #ddd;">
                                    <div style="margin-bottom: 10px;">
                                        <input type="text" id="invite-friend-name" placeholder="Friend's name (optional)" 
                                               style="padding: 8px; border: 1px solid #ccc; border-radius: 4px; width: 150px; margin-right: 5px;">
                                        <button id="copy-invite-link-btn" class="btn btn-primary" style="padding: 8px 15px;">
                                            Invite Player
                                        </button>
                                    </div>
                                    <div id="invite-link-preview" style="font-size: 0.85rem; color: #666; word-break: break-all;"></div>
                                </div>
                                
                                <button id="leave-room-btn" class="btn btn-secondary" style="margin-top: 15px;">Leave Room</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="timer-settings">
                        <h3>Timer Settings</h3>
                        <div class="timer-controls">
                            <div class="timer-control-group">
                                <label for="white-timer-minutes">White Player (Minutes)</label>
                                <input type="number" id="white-timer-minutes" min="0" max="120" value="10" class="timer-input">
                                <span class="timer-label-text">min</span>
                            </div>
                            <div class="timer-control-group">
                                <label for="black-timer-minutes">Black Player (Minutes)</label>
                                <input type="number" id="black-timer-minutes" min="0" max="120" value="10" class="timer-input">
                                <span class="timer-label-text">min</span>
                            </div>
                            <button id="apply-timer-btn" class="btn btn-secondary" style="margin-top: 10px;">Apply Timer Settings</button>
                        </div>
                    </div>
                    
                    <div class="bot-settings">
                        <h3>Bot Settings</h3>
                        <div class="bot-name-input">
                            <label for="bot-name">Bot Name</label>
                            <input type="text" id="bot-name" placeholder="Enter bot name" value="ChessBot" maxlength="20">
                        </div>
                        <div class="bot-difficulty-input">
                            <label for="bot-difficulty">Difficulty</label>
                            <select id="bot-difficulty" class="difficulty-select">
                                <option value="easy">Easy</option>
                                <option value="medium" selected>Medium</option>
                                <option value="hard">Hard</option>
                                <option value="expert">Expert</option>
                            </select>
                        </div>
                        <button id="play-bot-btn" class="btn btn-primary" style="margin-top: 10px;">Play Bot</button>
                    </div>
                    
                    <div class="controls">
                        <button id="new-game-btn" class="btn btn-primary">New Game</button>
                        <button id="reset-btn" class="btn btn-secondary">Reset</button>
                    </div>
                    
                    <div class="move-history">
                        <h3>Move History</h3>
                        <div id="move-list" class="move-list"></div>
                    </div>
                    
                    <div class="captured-pieces">
                        <div class="captured-section">
                            <h4>White Captured</h4>
                            <div id="white-captured" class="captured-container"></div>
                        </div>
                        <div class="captured-section">
                            <h4>Black Captured</h4>
                            <div id="black-captured" class="captured-container"></div>
                        </div>
                    </div>
                    
                    <div class="customization">
                        <h3>Customize Colors</h3>
                        <div class="board-style-section">
                            <h4>Board Style</h4>
                            <p class="board-style-hint">Click a board to apply it</p>
                            <div class="board-style-grid" id="board-style-grid">
                                <button type="button" class="board-style-tile" data-light="#f0d9b5" data-dark="#b58863" title="Classic"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#a8d5e2" data-dark="#4a90a4" title="Ocean"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#c8d5b9" data-dark="#6b8e5a" title="Forest"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#ffd4a3" data-dark="#ff8c5a" title="Sunset"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#e0e0e0" data-dark="#606060" title="Monochrome"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#e8e0c8" data-dark="#7d6b4a" title="Walnut"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#d4b896" data-dark="#8b6914" title="Maple"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#c4a574" data-dark="#5c4033" title="Mahogany"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#b0a090" data-dark="#4a4035" title="Ebony"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#e8e4d9" data-dark="#9a8f7f" title="Sand"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#a0c4e8" data-dark="#2c5282" title="Blue"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#c8e6c9" data-dark="#388e3c" title="Green"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#f8bbd0" data-dark="#c2185b" title="Rose"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#d1c4e9" data-dark="#512da8" title="Purple"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#ffcc80" data-dark="#e65100" title="Orange"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#b0bec5" data-dark="#455a64" title="Slate"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#cfd8dc" data-dark="#546e7a" title="Stone"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#90a4ae" data-dark="#263238" title="Graphite"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#eceff1" data-dark="#37474f" title="Marble"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#ef5350" data-dark="#1a0000" title="Red & Black"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#fff8e1" data-dark="#ff8f00" title="Amber"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#e1f5fe" data-dark="#01579b" title="Ice"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#fce4ec" data-dark="#880e4f" title="Blush"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#f3e5f5" data-dark="#4a148c" title="Lavender"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                                <button type="button" class="board-style-tile" data-light="#e8f5e9" data-dark="#1b5e20" title="Mint"><span class="board-style-preview"><span class="preview-cell light"></span><span class="preview-cell dark"></span><span class="preview-cell dark"></span><span class="preview-cell light"></span></span></button>
                            </div>
                        </div>
                        <div class="color-controls">
                            <div class="color-control-group">
                                <label for="light-square-color">Light Square</label>
                                <div class="color-input-group">
                                    <input type="color" id="light-square-color" value="#f0d9b5">
                                    <input type="text" id="light-square-text" value="#f0d9b5" class="color-text-input">
                                </div>
                            </div>
                            <div class="color-control-group">
                                <label for="dark-square-color">Dark Square</label>
                                <div class="color-input-group">
                                    <input type="color" id="dark-square-color" value="#b58863">
                                    <input type="text" id="dark-square-text" value="#b58863" class="color-text-input">
                                </div>
                            </div>
                            <div class="piece-colors-section">
                                <h4>Piece colors</h4>
                                <p class="piece-colors-hint">Customize the color of white and black pieces on the board.</p>
                                <div class="color-control-group">
                                    <label for="white-piece-color">White pieces</label>
                                    <div class="color-input-group">
                                        <input type="color" id="white-piece-color" value="#ffffff" title="White pieces color">
                                        <input type="text" id="white-piece-text" value="#ffffff" class="color-text-input" placeholder="#ffffff">
                                    </div>
                                </div>
                                <div class="color-control-group">
                                    <label for="black-piece-color">Black pieces</label>
                                    <div class="color-input-group">
                                        <input type="color" id="black-piece-color" value="#000000" title="Black pieces color">
                                        <input type="text" id="black-piece-text" value="#000000" class="color-text-input" placeholder="#000000">
                                    </div>
                                </div>
                            </div>
                            <div class="color-control-group">
                                <label for="board-container-color">Board Container</label>
                                <div class="color-input-group">
                                    <input type="color" id="board-container-color" value="#ffffff">
                                    <input type="text" id="board-container-text" value="#ffffff" class="color-text-input">
                                </div>
                            </div>
                            <div class="color-control-group">
                                <label for="background-theme-selector">Background Theme</label>
                                <select id="background-theme-selector" class="piece-set-selector">
                                    <optgroup label="Nature">
                                        <option value="rainy">Rainy Storm</option>
                                        <option value="ocean">Ocean Waves</option>
                                        <option value="forest">Forest Green</option>
                                        <option value="sunset">Sunset Sky</option>
                                        <option value="aurora">Aurora Borealis</option>
                                        <option value="mountain">Mountain Peak</option>
                                        <option value="desert">Desert Dunes</option>
                                        <option value="tropical">Tropical Paradise</option>
                                    </optgroup>
                                    <optgroup label="Space & Galaxy">
                                        <option value="space">Deep Space</option>
                                        <option value="nebula">Cosmic Nebula</option>
                                        <option value="galaxy">Milky Way</option>
                                        <option value="mars">Mars Surface</option>
                                        <option value="jupiter">Jupiter Storm</option>
                                    </optgroup>
                                    <optgroup label="Abstract & Modern">
                                        <option value="gradient1">Purple Dream</option>
                                        <option value="gradient2">Blue Ocean</option>
                                        <option value="gradient3">Sunset Fire</option>
                                        <option value="gradient4">Emerald Green</option>
                                        <option value="gradient5">Rose Gold</option>
                                        <option value="neon">Neon Nights</option>
                                        <option value="cyberpunk">Cyberpunk City</option>
                                        <option value="matrix">Matrix Code</option>
                                    </optgroup>
                                    <optgroup label="Dark & Moody">
                                        <option value="dark1">Midnight Blue</option>
                                        <option value="dark2">Charcoal Storm</option>
                                        <option value="dark3">Deep Purple</option>
                                        <option value="dark4">Blood Red</option>
                                        <option value="dark5">Shadow Realm</option>
                                    </optgroup>
                                    <optgroup label="Bright & Vibrant">
                                        <option value="bright1">Sunshine Yellow</option>
                                        <option value="bright2">Coral Reef</option>
                                        <option value="bright3">Lavender Fields</option>
                                        <option value="bright4">Mint Fresh</option>
                                        <option value="bright5">Peachy Keen</option>
                                    </optgroup>
                                    <optgroup label="Seasonal">
                                        <option value="spring">Spring Bloom</option>
                                        <option value="summer">Summer Beach</option>
                                        <option value="autumn">Autumn Leaves</option>
                                        <option value="winter">Winter Frost</option>
                                        <option value="christmas">Christmas Eve</option>
                                    </optgroup>
                                    <optgroup label="Artistic">
                                        <option value="watercolor">Watercolor</option>
                                        <option value="pastel">Pastel Dreams</option>
                                        <option value="vintage">Vintage Film</option>
                                        <option value="retro">Retro Wave</option>
                                        <option value="abstract">Abstract Art</option>
                                    </optgroup>
                                    <optgroup label="Special Effects">
                                        <option value="fire">Fire & Flame</option>
                                        <option value="ice">Ice Crystal</option>
                                        <option value="electric">Electric Storm</option>
                                        <option value="rainbow">Rainbow Spectrum</option>
                                        <option value="holographic">Holographic</option>
                                    </optgroup>
                                </select>
                            </div>
                            <div class="color-control-group">
                                <label for="piece-set-selector">Piece Style</label>
                                <select id="piece-set-selector" class="piece-set-selector">
                                    <optgroup label="Classic">
                                        <option value="unicode">Unicode Symbols</option>
                                        <option value="letters">Letter Notation</option>
                                        <option value="bold">Bold Unicode</option>
                                        <option value="circles">Circle Symbols</option>
                                        <option value="squares">Square Symbols</option>
                                        <option value="simple">Simple Shapes</option>
                                    </optgroup>
                                    <optgroup label="Music & Sports">
                                        <option value="rock">Rock Music</option>
                                        <option value="hipHop">Hip Hop</option>
                                        <option value="football">Football</option>
                                        <option value="basketball">Basketball</option>
                                    </optgroup>
                                    <optgroup label="Food & Lifestyle">
                                        <option value="pizza">Pizza</option>
                                        <option value="coffee">Coffee</option>
                                    </optgroup>
                                    <optgroup label="Nature & Space">
                                        <option value="ocean">Ocean Life</option>
                                        <option value="forest">Forest</option>
                                        <option value="space">Space</option>
                                    </optgroup>
                                    <optgroup label="Holidays">
                                        <option value="christmas">Christmas</option>
                                        <option value="halloween">Halloween</option>
                                        <option value="valentines">Valentine's Day</option>
                                        <option value="easter">Easter</option>
                                    </optgroup>
                                    <optgroup label="Style">
                                        <option value="retro">Retro 80s</option>
                                        <option value="cyberpunk">Cyberpunk</option>
                                        <option value="emoji">Emoji Party</option>
                                        <option value="rainbow">Rainbow</option>
                                        <option value="neon">Neon</option>
                                    </optgroup>
                                </select>
                            </div>
                        </div>
                        <div class="preset-themes">
                            <h4>Preset Themes</h4>
                            <div class="theme-buttons">
                                <button class="theme-btn" data-theme="classic">Classic</button>
                                <button class="theme-btn" data-theme="ocean">Ocean</button>
                                <button class="theme-btn" data-theme="forest">Forest</button>
                                <button class="theme-btn" data-theme="sunset">Sunset</button>
                                <button class="theme-btn" data-theme="monochrome">Monochrome</button>
                            </div>
                        </div>
                        <button id="reset-colors-btn" class="btn btn-secondary">Reset to Default</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Lessons Modal -->
        <div id="lessons-modal" class="lessons-modal">
            <div class="lessons-modal-content">
                <div class="lessons-modal-header">
                    <h2>üìö Chess Lessons</h2>
                    <button class="lessons-close-btn" id="lessons-close-btn" aria-label="Close">&times;</button>
                </div>
                <div class="lessons-modal-body">
                    <nav class="lessons-nav">
                        <button class="lesson-tab active" data-lesson="board">The Board</button>
                        <button class="lesson-tab" data-lesson="pieces">How Pieces Move</button>
                        <button class="lesson-tab" data-lesson="special">Special Moves</button>
                        <button class="lesson-tab" data-lesson="check">Check & Checkmate</button>
                        <button class="lesson-tab" data-lesson="tips">Opening Tips</button>
                    </nav>
                    <div class="lessons-content">
                        <article id="lesson-board" class="lesson-panel active">
                            <h3>The Board</h3>
                            <p>Chess is played on an 8√ó8 board. Each player starts with 16 pieces: one king, one queen, two rooks, two bishops, two knights, and eight pawns.</p>
                            <p><strong>Ranks</strong> are the horizontal rows (1‚Äì8). <strong>Files</strong> are the vertical columns (a‚Äìh). The board is set up so each player has a light square on their right.</p>
                            <p>White always moves first. The goal is to checkmate your opponent‚Äôs king.</p>
                        </article>
                        <article id="lesson-pieces" class="lesson-panel">
                            <h3>How the Pieces Move</h3>
                            <ul class="lesson-list">
                                <li><strong>King ‚ôî</strong> ‚Äî One square in any direction. Must never move into check.</li>
                                <li><strong>Queen ‚ôï</strong> ‚Äî Any number of squares in any direction (rank, file, or diagonal).</li>
                                <li><strong>Rook ‚ôñ</strong> ‚Äî Any number of squares along a rank or file (horizontally or vertically).</li>
                                <li><strong>Bishop ‚ôó</strong> ‚Äî Any number of squares along a diagonal. Stays on the same color.</li>
                                <li><strong>Knight ‚ôò</strong> ‚Äî Moves in an ‚ÄúL‚Äù: two squares in one direction, then one square perpendicular. It jumps over other pieces.</li>
                                <li><strong>Pawn ‚ôô</strong> ‚Äî One square forward (or two from the starting row). Captures one square diagonally forward. Does not capture straight ahead.</li>
                            </ul>
                        </article>
                        <article id="lesson-special" class="lesson-panel">
                            <h3>Special Moves</h3>
                            <ul class="lesson-list">
                                <li><strong>Castling</strong> ‚Äî Move the king two squares toward a rook, then move that rook to the square the king crossed. You can‚Äôt castle out of, through, or into check, or if the king or that rook has already moved.</li>
                                <li><strong>En passant</strong> ‚Äî When a pawn moves two squares and lands beside your pawn, you may capture it ‚Äúin passing‚Äù as if it had moved only one square (on your next move only).</li>
                                <li><strong>Promotion</strong> ‚Äî When a pawn reaches the opposite end of the board, it becomes a queen, rook, bishop, or knight (almost always a queen).</li>
                            </ul>
                        </article>
                        <article id="lesson-check" class="lesson-panel">
                            <h3>Check and Checkmate</h3>
                            <p><strong>Check</strong> ‚Äî Your king is under attack. You must get out of check on your next move (move the king, block, or capture the attacking piece).</p>
                            <p><strong>Checkmate</strong> ‚Äî The king is in check and has no legal move to escape. The game ends; the side that delivered checkmate wins.</p>
                            <p><strong>Stalemate</strong> ‚Äî It‚Äôs your turn, your king is not in check, but you have no legal move. The game is a draw.</p>
                        </article>
                        <article id="lesson-tips" class="lesson-panel">
                            <h3>Opening Tips</h3>
                            <ul class="lesson-list">
                                <li>Control the center (e4, d4, e5, d5 and the squares around them).</li>
                                <li>Develop your pieces (knights and bishops) early; avoid moving the same piece too many times.</li>
                                <li>Castle to keep your king safer and connect your rooks.</li>
                                <li>Don‚Äôt bring the queen out too early; she can be chased by enemy pieces.</li>
                                <li>Connect your rooks and try to activate them on open files.</li>
                            </ul>
                        </article>
                    </div>
                </div>
            </div>
        </div>

        </main>
    </div>

    <!-- PeerJS for peer-to-peer multiplayer -->
    <script src="https://unpkg.com/peerjs@1.5.4/dist/peerjs.min.js" crossorigin="anonymous"></script>
    
    <!-- Error Handling -->
    <script>
        // Global error handler
        window.addEventListener('error', function(e) {
            console.error('Global error:', e.error);
            // Don't show alerts in production, just log
            if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
                console.error('Error details:', e);
            }
        });

        // Handle unhandled promise rejections
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Unhandled promise rejection:', e.reason);
        });

        // Check if scripts loaded successfully
        window.addEventListener('load', function() {
            const scripts = ['auth.js', 'multiplayer.js', 'chess.js', 'rain.js'];
            scripts.forEach(function(script) {
                const scriptElement = Array.from(document.scripts).find(s => s.src.includes(script));
                if (!scriptElement) {
                    console.warn('Script may not have loaded:', script);
                }
            });
        });
    </script>
    
    <!-- Main Application Scripts -->
    <script src="auth.js"></script>
    <script src="multiplayer.js"></script>
    <script src="chess.js"></script>
    <script src="rain.js"></script>
</body>
</html>
